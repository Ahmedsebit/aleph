<div class="jumbotron">
  <h1>{{::statistics.documents_count | number}} gazettes</h1>
  <p class="teaser">from {{metadata.app.start_year}} to {{metadata.app.end_year}} available</p>
  <div class="search-area">
    <form class="form-horizontal actions" role="search" ng-submit="searchDocuments(form)">
      <div class="input-group">
        <input type="text" class="form-control" autofocus ng-model="documentsQuery.q"
            placeholder="{{::statistics.documents_count | number}} documents">
        <span class="input-group-btn">
          <button class="btn btn-primary" type="submit">Search</button>
        </span>
      </div>
      <p class="context sample-searches">
        Examples:
        <span ng-repeat="sample in metadata.app.samples">
          <span ng-if="$last">or</span>
          <a href="/documents?q={{::sample}}">{{::sample}}</a>
          <span ng-if="!$last">,</span>
        </span>
        ,
          or
        <a href="/documents/sources">browse sources</a>
        .
      </p>
    </form>
  </div>
</div>

<div class="home screen">
  <div class="row">
    <div class="col-md-4 feature">
      <h2> <i class="fa fa-fw fa-file-text"></i>
        Search documents
      </h2>

      <p>
        {{metadata.app.title}} lets you search across
        <a href="/collections">
          {{::statistics.collections_count | number}} collections
        of {{metadata.app.nationality}} gazettes
        </a>
        from {{metadata.app.opengazettes_url}}
      </p>
    </div>

    <div class="col-md-4 feature" ng-if="::!authz.logged_in()">
      <h2> <i class="fa fa-bell"></i>
        E-Mail Alerts
      </h2>
      <p>
        As new material gets added, you can stay informed about
        any additional matches for your previous searches by
        setting up e-mail alerts.
      </p>

    </div>

    <div class="col-md-4 feature">
      <h2>
        <i class="fa fa-fw fa-users"></i>
        Persons of interest
      </h2>
      <p>
        Gazettes are cross-referenced with persons and companies by ID and CIPC numbers respectively.
      </p>
      <form class="form-horizontal actions" role="search" ng-submit="searchEntities(form)">
        <div class="input-group">
          <input type="text" class="form-control" autofocus ng-model="entitiesQuery.q"
            placeholder="{{::statistics.entities_count | number}} people and companies">
          <span class="input-group-btn">
            <button class="btn btn-primary" type="submit">Search</button>
          </span>
        </div>
        <p class="context">
          <a href="/datasets">Browse databases</a>.
        </p>
      </form>
    </div>
  </div>
  <div class="row dark-row">
    <div class="col-md-4 col-md-offset-4">
      <h2> <i class="fa fa-fw fa-newspaper-o"></i>
        What's Happening
      </h2>
    </div>
      <div id="newsCarousel" class="carousel slide" ng-non-bindable data-interval="false" data-ride="carousel">

      <!-- Indicators -->
        <ol class="carousel-indicators">

        </ol>

        <!-- Wrapper for slides -->
        <div class="carousel-inner">


          <!-- Left and right controls -->
          <a class="carousel-control" data-target="#newsCarousel" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="right-ctrl carousel-control" data-target="#newsCarousel" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
      </div>
    </div>
</div>
<script>
  var spreadsheetID = "1SN02GD7b4d2dqrbgfrWE2bclSorXYF5E6UqhNFjaWig";
  var url = "https://spreadsheets.google.com/feeds/list/" + spreadsheetID + "/od6/public/values?alt=json";
  $.getJSON(url, function(data) {
    var entry = data.feed.entry;
    var news_set_index = 0;
    $(entry).each(function(index) {
      // Columns: Title, Descriptions, Publish Date, Author Name, Image URL, Story URL.
      console.log("news_set_index before: " + news_set_index);
      if (index % 4 === 0) {
        var active = "";
        if (news_set_index === 0) {
          active = "active";
        } else {
          active = "";
        }
        // Create a new news set div
        $('#newsCarousel .carousel-inner').append(
        '<div id="news-set-' + news_set_index + '" class="item ' + active + '"></div>');

        // Create a new indicator for the new news-set
        $('#newsCarousel .carousel-indicators').append(
        '<li data-target="#newsCarousel" data-slide-to="' + news_set_index +
        '" class="' + active + '"></li>');
        // Finally increment the news-set index
        news_set_index += 1;
        console.log("incrementing news_set_index: " + news_set_index);
      }

       $('#newsCarousel .carousel-inner #news-set-' + (news_set_index - 1)).append(
          '<h2>'+ this.gsx$title.$t + '</h2><p>' +
          this.gsx$descriptions.$t + '</p>');
    });
  });
</script>
